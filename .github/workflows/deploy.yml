# Simple cURL FTP Deployment (Should work with WebSupport.sk)
# File: .github/workflows/simple-deploy.yml

name: Simple FTP Deploy

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  deploy:
    name: Upload Files via cURL FTP
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Test FTP Connection First
        run: |
          echo "ðŸ” Testing FTP connection..."
          curl -v --ftp-pasv \
            -u "${{ secrets.FTP_USERNAME }}:${{ secrets.FTP_PASSWORD }}" \
            "ftp://${{ secrets.FTP_HOST }}/palacebar.sk/web/" \
            --max-time 30 \
            2>&1 | head -20

      - name: Upload HTML Files
        run: |
          echo "ðŸ“„ Uploading HTML files..."
          for file in *.html; do
            if [ -f "$file" ]; then
              echo "Uploading: $file"
              curl --ftp-create-dirs --ftp-pasv \
                -T "$file" \
                -u "${{ secrets.FTP_USERNAME }}:${{ secrets.FTP_PASSWORD }}" \
                "ftp://${{ secrets.FTP_HOST }}/palacebar.sk/web/$file" \
                --max-time 60
            fi
          done

      - name: Upload CSS Files  
        run: |
          echo "ðŸŽ¨ Uploading CSS files..."
          for file in *.css; do
            if [ -f "$file" ]; then
              echo "Uploading: $file"
              curl --ftp-create-dirs --ftp-pasv \
                -T "$file" \
                -u "${{ secrets.FTP_USERNAME }}:${{ secrets.FTP_PASSWORD }}" \
                "ftp://${{ secrets.FTP_HOST }}/palacebar.sk/web/$file" \
                --max-time 60
            fi
          done

      - name: Upload JavaScript Files
        run: |
          echo "âš¡ Uploading JavaScript files..."
          for file in *.js; do
            if [ -f "$file" ]; then
              echo "Uploading: $file"
              curl --ftp-create-dirs --ftp-pasv \
                -T "$file" \
                -u "${{ secrets.FTP_USERNAME }}:${{ secrets.FTP_PASSWORD }}" \
                "ftp://${{ secrets.FTP_HOST }}/palacebar.sk/web/$file" \
                --max-time 60
            fi
          done

      - name: Upload Other Files (Images, etc.)
        run: |
          echo "ðŸ“ Uploading other files..."
          for file in *.png *.jpg *.jpeg *.gif *.svg *.ico *.pdf *.txt; do
            if [ -f "$file" ]; then
              echo "Uploading: $file"
              curl --ftp-create-dirs --ftp-pasv \
                -T "$file" \
                -u "${{ secrets.FTP_USERNAME }}:${{ secrets.FTP_PASSWORD }}" \
                "ftp://${{ secrets.FTP_HOST }}/palacebar.sk/web/$file" \
                --max-time 60
            fi
          done

      - name: Success Message
        run: |
          echo "ðŸŽ‰ Deployment completed successfully!"
          echo "ðŸŒ Your website is live at: https://palacebar.sk/"
          echo "ðŸ“… Deployment time: $(date)"
          echo "ðŸ“ Files uploaded from commit: ${{ github.sha }}"
          
          echo ""
          echo "ðŸ“‹ Uploaded files:"
          echo "  â€¢ HTML: $(ls *.html 2>/dev/null | wc -l) files"
          echo "  â€¢ CSS: $(ls *.css 2>/dev/null | wc -l) files" 
          echo "  â€¢ JS: $(ls *.js 2>/dev/null | wc -l) files"
